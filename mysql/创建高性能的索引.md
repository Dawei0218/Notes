# 创建高性能的索引

索引按照顺序存储数据，所以MySQL可以被用来做order by和group by操作

三星索引

* 索引将相关的记录放在一起则获得一星
* 如果所有中的数据顺序和查找中的顺序一致则获得二星
* 如果索引中的列包含了查询中需要的全部列则获得3星

-------

### 用不上索引

```mysql
select id from t where id + 1 = 5;
```

------

### 前缀索引

比较长的字符串可以使用部分字符，这样可以大大节约索引空间，从而提高索引效率。

这样也会降低索引的选择性。

索引的选择性指不重复的索引值（也称基数）和数据表的记录总数的比值。

count(DISTINCT  left(字段， 3) )  / count(*)的比值。比值越大越好

------

### 联合索引决定索引顺序

```mysql
select sum(staff_id = 2), sum(customer_id = 566) from t; # 这样对其他条件不公平

select count(distinct staff_id)/count(*) as staff_id_selectivity,count(distinct customer_id)/count(*) as customer_id_selectivity, count(*) from t; # 把不重复基数比较大的放在前面
```

应该把索引数少的放在前面。



------

optimize table。优化表