# 拷贝控制

### 拷贝构造函数与拷贝赋值

```cpp
// 拷贝初始化发生条件
// 1. 使用=号定义变量时
// 2. 将一个对象作为实参传递给一个非引用类型的形参
// 3. 从一个类型为非引用类型的函数返回一个对象
// 4. 用花括号列表初始化一个数组中的元素（比如vector）

// 如果我们没有定义拷贝构造函数或拷贝赋值，编译器默认生成，即使定义了其他构造函数
class S 
{
public:
  // 拷贝构造，第一个参数必须是引用类型
  // 从给定对象中依次将每个非static成员拷贝到正在创建的对象中，类类型对象会调用其拷贝构造函数进行拷贝
  S(const S&);
    
  // 拷贝赋值，可能需要检查自引用
  S& operator=(const S& s1) {}
}
```

------

### 析构函数

```cpp
// 变量离开作用域时被销毁
// 当一个对象被销毁时，其成员被销毁
// 容器、数组被销毁，其元素被销毁
// delete
// 临时对象
class S {
public:
  ~S();
};
```

------

### 移动构造函数与移动赋值运算符

```cpp
// 如果定义了自己的拷贝构造、拷贝赋值或析构函数，编译器则不会默认生成
// 使用std::move转换成右值，在utility头文件中
class S
{
public:
  // 只有noexcept容器才会调用移动构造
  S(S &&s1) noexcept
  {
    p_ = s1.p_;
    s1.p_ = nullptr;
  }
  
  S& operator=(S &&s1) noexcept {}
private:
  int *p_;
}

S s2(std::move(s1));
```


