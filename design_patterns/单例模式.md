# 单例模式

> Singleton Design Pattern

### 为什么要用单例？

​	减少资源重复创建，节省内存以及文件句柄

------

### 饿汉式

```java
public class IdGenerator { 
  private AtomicLong id = new AtomicLong(0);
  private static final IdGenerator instance = new IdGenerator();
  private IdGenerator() {}
  public static IdGenerator getInstance() {
    return instance;
  }
  public long getId() { 
    return id.incrementAndGet();
  }
}
```

1. 不支持延迟加载，在程序启动的时候就初始化，不管用不用
2. 程序可能会启动慢（但是在用的时候不用在初始化）
3. 线程安全的

------

### 懒汉式

```java
public class IdGenerator { 
  private AtomicLong id = new AtomicLong(0);
  private static IdGenerator instance;
  private IdGenerator() {}
  public static synchronized IdGenerator getInstance() {
    if (instance == null) {
      instance = new IdGenerator();
    }
    return instance;
  }
  public long getId() { 
    return id.incrementAndGet();
  }
}
```

1. 在使用的时候在初始化，非线程安全，需要在创建的时候加锁
2. 加锁的时候，需要双重检测才能避免二次创建