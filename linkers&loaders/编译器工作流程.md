# 编译器编译过程

### 编译过程

```
1. 扫描
2. 语法分析
3. 语义分析
4. 源代码优化
5. 代码生成
6. 目标代码优化
```

从源代码到最终目标代码的过程

------

### 词法分析

```
1. 源代码被输入到扫描器
2. 扫描器进行词法分析（运用类似于有限状态机的算法）将字符序列分割成记号（token）
3. 在处理成token的同时，也将标识符放到符号表，数字字符串放到文字表等
```

预处理不归入编译器的范围，交给独立的预处理器

------

### 语法分析

```
1. 语法分析器对token进行语法分析，生成语法树
2. 如果出现表达式不合法就会报告语法分析阶段的错误
```

------

### 语义分析

```
1. 语法分析器仅仅完成了表达式的语法层面的分析，不知道具体的意义
2. 包括声明和类型的匹配，类型的转换
3. 经过语义分析之后，整个语法树的表达式都被表示了类型
```

------

### 中间语言生成

```
1. 源代码优化器在源代码级别进行优化，比如2 + 6直接优化掉，变成8
2. 直接在语法树上进行优化比较困难，生成中间代码。比如三地址码和P-代码
```

中间代码使得编译器可以分为前端和后端，前端负责产生机器无关的中间代码，后端将中间代码转换成目标机器代码。

所以对一些跨平台的编译器，可以针对不同平台使用同一个前端，针对不同平台使用数个后端。

------

### 目标代码生成与优化

```
1. 代码生成器将中间代码转换成目标机器代码
2. 目标代码优化器进行优化，比如选择合适的寻址方式、位移代替乘法运算，删除多余的指令
```

此过程都属于编译器后端，编译器后端包括代码生成器和目标代码优化器。

------

### 总结

经过以上步骤编译成了目标代码，但是地址还没有确认。

所以需要链接器的存在