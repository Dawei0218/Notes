# TIME_WAIT

### 为什么要有TIME_WAIT

- 确保最后的ACK能让被动关闭方接收，从而帮助其正常关闭
- 为了容错设计，可能又重新创建一个原连接的化身，如果迷失报文在这个时候到达就会造成错误

------

### 解决方案

```C
// 当客户端与服务端主机时间不同步时，客户端的发送的消息会被直接拒绝掉
// 只适用连接发起的一方
// 需要net.ipv4.tcp_timestamps=1
// 现代 Linux 系统引入了更安全可控的方案，可以帮助我们尽可能地复用 TIME_WAIT 状态的连接。
net.ipv4.tcp_tw_reuse
```

