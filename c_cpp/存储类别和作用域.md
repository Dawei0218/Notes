# 存储类别和作用域

### 作用域

1. 描述程序中可访问标识符的区域
2. 一个C变量的作用域可以是块作用域、函数作用域、函数原型作用域或文件作用域

```c
// 整个函数是一个块，函数中的任意符合语句也是一个块
int main(void)
{
	if(1) {
        int a = 1; // a的作用域开始
    } // a的作用域结束
}

// 函数作用域
// 即使一个标签首次出现在内层块中，它的作用域也延展至整个函数
int main(void)
{
    goto err;
    if(0) {
        err:
        	printf("this is err label \n");
    }
}

// 函数原型作用域，只适用于函数原型声明的参数名
// 函数原型作用域的范围是从形参定义处到原型声明结束
// 这意味着，编译器在处理函数原型中的形参时，只关心它的类型，而形参名通常无关紧要
int func(int a, int b);

// 文件作用域
// 变量定义在函数外面，具有文件作用域
// 对于文件作用域的变量，static表明了其链接属性。因为所有的文件作用域都具有静态存储区
// 函数名也拥有文件作用域
int a; // 文件作用域，外部链接
static int b; // 文件作用域，内部链接
int main(void) {}
```

------

### 存储期

1. C对象有4种存储器：静态存储期、线程存储期、自动存储期、动态分配存储期
2. 块作用域的变量通常都具有自动存储期。当程序进入时分配内存，离开时回收
3. 关键字_Thread_local声明一个对象时，每个线程都获得该变量的私有备份
4. auto是存储类别说明符，自动变量

------

### static

```c
// 对于文件作用域的变量，static表明其链接属性为内部链接。因为所有的文件作用域都具有静态存储期
static int a = 1;
int main(void) {
    // b具有静态存储期，只不过是块作用域
    static int b = 2;
}
```

------

### 初始化外部变量

```c
// 未初始化的外部变量被初始化为0
// 只能使用常量表达式初始化文件作用域变量
int x = 10;
int y = 3 + 10;
size_t z = sizeof(int);
int x2 = 2 * x; // 错误，x是变量
```

