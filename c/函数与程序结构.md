# 函数与程序结构

### 函数

```c
// int是返回类型, int a是参数
// 作为函数定义的形式参数char s[]和chat *s是一样的
int demo(int a) {}
```

-------

### 内联函数

```c
// 不会函数调用，直接嵌到调用处
inline static void eatline() {}
```

------

### 存储类型

1. 变量存储在普通内存、运行时堆栈、硬件寄存器这三个地方
2. 任何代码块之外声明的变量存储于静态内存中，不属于堆栈的内存，在运行前就创建，被称为静态(static)变量
3. 在代码代码内部声明的缺省类型是自动(auto)变量，存储在堆栈中。如果加上static就会变成静态变量。
4. register变量，存储在机器的寄存器中。
5. 静态变量会被初始化为0，自动变量不会被初始化。

------

### 外部变量(external)

```c
// file1
int a;
// file2 可以使用并且修改file1的值
extern int a; 
```

1. 函数或变量默认是external，在其他源文件使用extern声明时，引用的是同一个对象
2. 局部变量在函数调用时创建，在退出时销毁。而外部变量是永久存在的。

------

### static变量

```c
static int a = 10;
static int demo() {}
```

1. 默认声明具有external链接属性，static可以使它的链接属性变成internal(源文件内部使用，不能被其他源文件使用)。
2. static也可以声明内部变量，就会从自动变量变成static变量。
3. 代码块外部的变量缺省存储于静态内存中，如果加上static就是限制链接属性。

------

### register变量

```c
register int x;
```

使用频率较高，放入机器的寄存器里。

------

### 宏替换

```c
#define 名字 替换文本
#define max(A, B) ((A) > (B) ? (A) : (B)) // 使用参数必须在括号
#define square(x) x * x  // 错误写法，没有括号

// #表示吧宏的参数替换成字符串常量
#define  message_for(a, b)  \
    printf(#a " and " #b ": We love you!\n")
// message_for(Carole, Debra); result: Carole and Debra: We love you!

// ## 可以把两个标记合并为一个标记 result: 输出token34的值
#define tokenpaster(n) printf ("token" #n " = %d", token##n)
int token34 = 40;
tokenpaster(34);
```

出现名字标记的地方都会被替换成文本，如果有多行需要在待续的行末尾加上\。

为什么要加上括号，如果使用square(a+1)，会被替换成 x+1 * a + 1，所以加上括号保证运算正确性。

------

### 条件包含

```c
#ifndef HDR
#define HDR

// .h文件

#endif
```

